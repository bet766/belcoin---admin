<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chat App</title>

<style>
* {
  box-sizing: border-box;
  font-family: Arial, sans-serif;
}

body {
  margin: 0;
  background: linear-gradient(135deg, #00c853, #0091ea);
  height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
}

.container {
  width: 360px;
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 10px 30px rgba(0,0,0,.2);
  overflow: hidden;
}

.tabs {
  display: flex;
}

.tabs button {
  flex: 1;
  padding: 15px;
  border: none;
  cursor: pointer;
  font-size: 16px;
  background: #e0e0e0;
}

.tabs button.active {
  background: #00c853;
  color: #fff;
  font-weight: bold;
}

.form {
  padding: 20px;
  display: none;
}

.form.active {
  display: block;
}

h2 {
  text-align: center;
  margin-bottom: 20px;
}

input {
  width: 100%;
  padding: 12px;
  margin-bottom: 12px;
  border-radius: 6px;
  border: 1px solid #ccc;
  font-size: 15px;
}

button.action {
  width: 100%;
  padding: 12px;
  background: #0091ea;
  border: none;
  color: white;
  font-size: 16px;
  border-radius: 6px;
  cursor: pointer;
}

button.action:hover {
  opacity: 0.9;
}
</style>
</head>

<body>

<div class="container">
  <div class="tabs">
    <button id="tabLogin" class="active">Login</button>
    <button id="tabCadastro">Cadastro</button>
  </div>

  <!-- LOGIN -->
  <div id="loginForm" class="form active">
    <h2>Entrar</h2>
    <input type="email" id="loginEmail" placeholder="Email">
    <input type="password" id="loginSenha" placeholder="Senha">
    <button class="action" onclick="login()">Entrar</button>
  </div>

  <!-- CADASTRO -->
  <div id="cadastroForm" class="form">
    <h2>Criar Conta</h2>
    <input type="text" id="cadNome" placeholder="Nome">
    <input type="email" id="cadEmail" placeholder="Email">
    <input type="password" id="cadSenha" placeholder="Senha">
    <button class="action" onclick="cadastrar()">Cadastrar</button>
  </div>
</div>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } 
from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
import { getFirestore, doc, setDoc } 
from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCb3qXhVccF5zaM1kT7Y0qSgpyJlltTWSE",
  authDomain: "chat-a1210.firebaseapp.com",
  projectId: "chat-a1210",
  storageBucket: "chat-a1210.firebasestorage.app",
  messagingSenderId: "158588715768",
  appId: "1:158588715768:web:15d8dd4f109250954cb10d"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// ABAS
const tabLogin = document.getElementById("tabLogin");
const tabCadastro = document.getElementById("tabCadastro");
const loginForm = document.getElementById("loginForm");
const cadastroForm = document.getElementById("cadastroForm");

tabLogin.onclick = () => {
  tabLogin.classList.add("active");
  tabCadastro.classList.remove("active");
  loginForm.classList.add("active");
  cadastroForm.classList.remove("active");
};

tabCadastro.onclick = () => {
  tabCadastro.classList.add("active");
  tabLogin.classList.remove("active");
  cadastroForm.classList.add("active");
  loginForm.classList.remove("active");
};

// CADASTRO
window.cadastrar = async () => {
  const nome = cadNome.value.trim();
  const email = cadEmail.value.trim();
  const senha = cadSenha.value.trim();

  if (!nome || !email || !senha) {
    alert("Preencha todos os campos");
    return;
  }

  try {
    const userCred = await createUserWithEmailAndPassword(auth, email, senha);
    await setDoc(doc(db, "users", userCred.user.uid), {
      nome,
      email,
      codigo: Math.floor(100000 + Math.random() * 900000)
    });
    alert("Conta criada com sucesso!");
    tabLogin.click();
  } catch (e) {
    alert(e.message);
  }
};

// LOGIN
window.login = async () => {
  const email = loginEmail.value.trim();
  const senha = loginSenha.value.trim();

  if (!email || !senha) {
    alert("Preencha todos os campos");
    return;
  }

  try {
    await signInWithEmailAndPassword(auth, email, senha);
    alert("Login realizado!");
  } catch (e) {
    alert("Email ou senha inv√°lidos");
  }
};
</script>

</body>
</html>
